
<div style="text-align:center" id = "main-lb-content-dynamic_index">
  <div id = "header-lb-dynamic_index"></div>     

  <table class = "table table-hover" id="tablehead-lb-dynamic_index">
      
    <tbody id = "t-incr-dynamic_index"></tbody>
  </table>
  <div id="waiting-div"></div>
  
</div>

<script>
    document.querySelector("#waiting-div").innerHTML = '<img id="waiting" src="https://i.pinimg.com/originals/23/35/32/23353292cc60b2bcb3f015ee362eeb74.gif"  width=250/>'; 
    fetch("called_mechanic_url") // WARNING: should be replaced by a concrete mechanic url
        .then(function (response) {
            return response.json();
        })
        .then(function (myJson) {
            document.querySelector("#header-lb-dynamic_index").innerHTML = '<h2>' + myJson.title + '</h2>';
            var users = Object.keys(myJson.leadders);
            var scores = Object.values(myJson.leadders);
            document.querySelector("#tablehead-lb-dynamic_index").innerHTML +=   '<thead id="tablehead-lb-dynamic_index"><tr>'+
                                                                                    '<th id="head-col1-dynamic_index" style="text-align:center">Username</th>'+
                                                                                    '<th id="score-type-dynamic_index" style="text-align:center">' + myJson.sort_by + '</th>'+
                                                                                  '</tr></thead>';
            
            //document.querySelector("#extra").innerHTML = "Length = " + myJson.length + ", Type = " + myJson.mechanic_type; 
            document.querySelector("#waiting").src = "";
            users.forEach(populateTable);
            function populateTable(item, index) {
                //alert(myJson.user.email );
                document.querySelector("#t-incr-dynamic_index").innerHTML += 
                    "<tr>" + 
                        "<td>" + item + "</td>" + 
                        "<td>" + scores[index] + "</td>" + 
                    "</tr>";
            }   
        })
        .catch(function (error) {
            console.log("Error: " + error);
        });
</script> 


      